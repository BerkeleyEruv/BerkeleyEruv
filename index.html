<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is It In A Bay Area Eruv?</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
            margin-top: 10px;
        }
        #map {
            height: 400px; /* Adjust the height as needed */
            width: 80%; /* Adjust the width as needed */
            margin-top: 10px;
            margin-bottom: 20px;
        }
        #result {
            margin-top: 20px;
            display: inline-block;
        }
        #check-container {
            display: flex;
            align-items: center;
        }
        #check-container button {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Check Address Within Region</h1>
    <div id="check-container">
        <input type="text" id="addressInput" placeholder="Enter address" />
        <button onclick="checkAddress()">Check</button>
        <div id="result"></div>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        const regionData = {
            "type": "FeatureCollection",
            "features": [
                // First polygon
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [ -122.2940704, 37.8927571 ], [ -122.2920034, 37.8863811 ], [ -122.2915454, 37.8850121 ], [ -122.2888344, 37.8788921 ], [ -122.2888754, 37.8788831 ], [ -122.2890744, 37.8792281 ], [ -122.2894054, 37.8793111 ], [ -122.2899704, 37.8779141 ], [ -122.2900774, 37.8773921 ], [ -122.2916824, 37.8765471 ], [ -122.2916404, 37.8763091 ], [ -122.2908734, 37.8738681 ], [ -122.2901174, 37.8739651 ], [ -122.2900864, 37.8738131 ], [ -122.2900074, 37.8731691 ], [ -122.2895864, 37.8694521 ], [ -122.2892274, 37.8674991 ], [ -122.2879609, 37.8613764 ], [ -122.2877262, 37.861313 ], [ -122.2874128, 37.8613428 ], [ -122.2872541, 37.8605668 ], [ -122.2870752, 37.8605963 ], [ -122.2855626, 37.8607883 ], [ -122.2855396, 37.8606448 ], [ -122.2854245, 37.8606562 ], [ -122.2853359, 37.8603267 ], [ -122.2852956, 37.860325 ], [ -122.285203, 37.8599411 ], [ -122.2807874, 37.8605001 ], [ -122.2806224, 37.8601441 ], [ -122.2802944, 37.8601051 ], [ -122.2797504, 37.8570811 ], [ -122.2795884, 37.8569141 ], [ -122.2774084, 37.8571951 ], [ -122.2775284, 37.8570361 ], [ -122.2771714, 37.8552641 ], [ -122.2770784, 37.8552391 ], [ -122.2712224, 37.8561161 ], [ -122.2724294, 37.8669181 ], [ -122.2724514, 37.8669271 ], [ -122.2734024, 37.8668411 ], [ -122.2734964, 37.8670301 ], [ -122.2736004, 37.8677171 ], [ -122.2737954, 37.8676841 ], [ -122.2741034, 37.8704591 ], [ -122.2751074, 37.8703911 ], [ -122.2760864, 37.8792561 ], [ -122.2750834, 37.8794421 ], [ -122.2751624, 37.8800641 ], [ -122.2758254, 37.8861411 ], [ -122.2766464, 37.8887811 ], [ -122.2764784, 37.8890601 ], [ -122.2773014, 37.8927511 ], [ -122.2772674, 37.8930101 ], [ -122.2769094, 37.8938221 ], [ -122.2769734, 37.8940751 ], [ -122.2780014, 37.8952621 ], [ -122.2808694, 37.8937931 ], [ -122.2810234, 37.8936651 ], [ -122.2841574, 37.8956841 ], [ -122.2849744, 37.8962321 ], [ -122.2851714, 37.8964841 ], [ -122.2872814, 37.8965451 ], [ -122.2873724, 37.8948641 ], [ -122.2874154, 37.8947031 ], [ -122.2892254, 37.8947391 ], [ -122.2892894, 37.8931881 ], [ -122.2890084, 37.8928711 ], [ -122.2916074, 37.8929391 ], [ -122.2918084, 37.8928071 ], [ -122.2919534, 37.8928761 ], [ -122.2927704, 37.8929251 ], [ -122.2925724, 37.8976661 ], [ -122.2954044, 37.8977471 ], [ -122.2955864, 37.8974661 ], [ -122.2940704, 37.8927571 ]
                        ]]
                    }
                },
                // Add more polygons here
                // Second polygon example - Richmond Eruv
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [-122.504082,37.780857,0],[-122.503459,37.772462,0],[-122.503438,37.772055,0],[-122.503138,37.771817,0],[-122.502859,37.771699,0],[-122.490585,37.772292,0],[-122.47977,37.772801,0],[-122.474792,37.773038,0],[-122.474513,37.773242,0],[-122.475157,37.781807,0],[-122.475178,37.782366,0],[-122.475543,37.782434,0],[-122.487195,37.781926,0],[-122.502944,37.781162,0],[-122.503749,37.781128,0],[-122.504082,37.780857,0]
                        ]]
                    }
                },
		// Mission Eruv
		{
                    "type": "Feature",
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            

[-122.417197,37.761987,0],[-122.438278,37.760719,0],[-122.437945,37.752789,0],[-122.436467,37.75277,0],[-122.435642,37.743956,0],[-122.433405,37.744088,0],[-122.433351,37.74332,0],[-122.431125,37.743456,0],[-122.430955,37.741845,0],[-122.424256,37.742247,0],[-122.424412,37.743847,0],[-122.42268,37.74395,0],[-122.422228,37.745298,0],[-122.422322,37.746389,0],[-122.424644,37.746253,0],[-122.424776,37.747805,0],[-122.423267,37.747898,0],[-122.423268,37.747987,0],[-122.42477,37.74791,0],[-122.424864,37.748647,0],[-122.41488,37.749242,0],[-122.415659,37.75724,0],[-122.416749,37.757188,0],[-122.417197,37.761987,0]

             		]]
                    }
                }
            ]
        };

        const map = L.map('map').setView([37.812671439479544, -122.36393137656991], 14); // Adjusted center

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Add polygons to the map
        regionData.features.forEach(feature => {
            const polygon = L.polygon(feature.geometry.coordinates[0].map(coord => [coord[1], coord[0]]))
                .addTo(map)
                .bindPopup("Region Boundary");
            
        });

	// Set the map view to your desired location
	map.setView([37.812671439479544, -122.36393137656991], 11);


        function checkAddress() {
            const address = document.getElementById('addressInput').value;
            if (!address) {
                document.getElementById('result').innerText = "Please enter an address.";
                return;
            }

            fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(address)}&key=AIzaSyDs4SRSnFRDktQ-KU_BmkTVD0Xm8wnhjuc`)
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'OK') {
                        const location = data.results[0].geometry.location;
                        const point = [location.lat, location.lng];
                        
                        L.marker(point).addTo(map)
                            .bindPopup("Input Address")
                            .openPopup();

                        map.setView(point, 14);

                        const isInside = regionData.features.some(feature => 
                            isPointInPolygon([location.lng, location.lat], feature.geometry.coordinates[0])
                        );
                        document.getElementById('result').innerText = isInside ? "Inside an Eruv (Consult the local Rabbi to be sure)" : "Outside the Eruv";
                    } else {
                        document.getElementById('result').innerText = "Address not found.";
                    }
                });
        }

        function isPointInPolygon(point, vs) {
            let x = point[0], y = point[1];

            let inside = false;
            for (let i = 0, j = vs.length - 1; i < vs.length; j = i++) {
                let xi = vs[i][0], yi = vs[i][1];
                let xj = vs[j][0], yj = vs[j][1];

                let intersect = ((yi > y) !== (yj > y)) &&
                    (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
                if (intersect) inside = !inside;
            }

            return inside;
        }
    </script>
</body>
</html>
